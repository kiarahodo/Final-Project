---
title: "Homework 5"
author: "Kiara Hodo"
date: "11/17/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Reading Data into R

```{r}
library(readr)
homicide_data <- read_csv("~/Fall 21 CSU/R Programming/Final Project/data/homicide-data.csv")
homicide_data
```

# Filtering down to Atlanta

```{r}
library(dplyr)
atl_homicides <- homicide_data %>%
  filter(city == "Atlanta")
atl_homicides
```
# Seperating Data into Solved and Unsolved 
```{r}
library(forcats)
library(sf)

unsolved <- atl_homicides %>%
  mutate(unsolved = disposition %in% c("Closed without arrest", "Open/No Arrest"))
  


```

# Making lower layer map of GA (Tigris package)
```{r}
library(tigris)
ga_counties <- counties(state = "GA", cb = TRUE, class = "sf")

fulton_atl <- ga_counties %>%
  filter(COUNTYFP == 121)
fulton_atl

?tracts
fulton_tracts <- tracts(state = "GA", county = 121, cb = TRUE)

library(ggplot2)
ggplot() + 
  geom_sf(data = fulton_atl) +
  geom_sf(data = fulton_tracts)

```
```{r}
fulton_homicdes <- st_as_sf(unsolved, coords = c("lon", "lat")) %>% 
  st_set_crs(4269)

```

# Making dots on map 
```{r}

?fct_lump

ggplot() + 
  geom_sf(data = ga_counties, color = "lightgray") + 
  geom_sf(data = fulton_homicdes, aes(color = month(begin_date_time),
                                  shape = time)) + 
  scale_color_viridis(name = "Month") 
```

